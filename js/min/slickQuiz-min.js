/*!
 * SlickQuiz jQuery Plugin
 * http://github.com/jewlofthelotus/SlickQuiz
 *
 * @updated October 25, 2014
 * @version 1.5.20
 *
 * @author Julie Cameron - http://www.juliecameron.com
 * @copyright (c) 2013 Quicken Loans - http://www.quickenloans.com
 * @license MIT
 */
!function($){$.slickQuiz=function(e,n){var t=this,a=$(e),o="#"+a.attr("id"),s={checkAnswerText:"Show Answer",nextQuestionText:"Next Question",backButtonText:"",completeQuizText:"",tryAgainText:"",questionCountText:"%current",preventUnansweredText:"You must select at least one answer.",questionTemplateText:"%count. %text",scoreTemplateText:"%score / %total",nameTemplateText:"<span>Quiz: </span>%name",skipStartButton:!1,numberOfQuestions:null,randomSortQuestions:!1,randomSortAnswers:!1,preventUnanswered:!1,disableScore:!1,disableRanking:!1,scoreAsPercentage:!1,perQuestionResponseMessaging:!0,perQuestionResponseAnswers:!1,completionResponseMessaging:!1,displayQuestionCount:!0,displayQuestionNumber:!0,animationCallbacks:{setupQuiz:function(){},startQuiz:function(){},resetQuiz:function(){},checkAnswer:function(){},nextQuestion:function(){},backToQuestion:function(){},completeQuiz:function(){}},events:{onStartQuiz:function(e){},onCompleteQuiz:function(e){}}},l="questionCount",r="questions",c="question",u="answers",d="responses",p="complete",f="correctResponse",h="incorrectResponse",m="correct",g="incorrect",v="checkAnswer",b="nextQuestion",k="lastQuestion",y="backToQuestion",Q="tryAgain",w="."+l,z="."+r,x="."+c,C="."+u,T="."+u+" li",q="."+d,A="."+d+" li",R="."+f,S="."+m,K="."+g,N="."+v,I="."+b,M="."+y,O="."+Q,_=o+" .startQuiz",U=o+" .quizName",G=o+" .quizArea",B=o+" .quizResults",D=o+" .quizResultsCopy",P=o+" .quizHeader",L=o+" .quizScore",j=o+" .quizLevel",F=$(_),J=$(U),H=$(G),Y=$(B),E=$(D),V=$(P),W=$(L),X=$(j),Z="";n&&"undefined"!=typeof n.disableNext&&("undefined"==typeof n.preventUnanswered&&(n.preventUnanswered=n.disableNext),Z+="The 'disableNext' option has been deprecated, please use 'preventUnanswered' in it's place.\n\n"),n&&"undefined"!=typeof n.disableResponseMessaging&&("undefined"==typeof n.preventUnanswered&&(n.perQuestionResponseMessaging=n.disableResponseMessaging),Z+="The 'disableResponseMessaging' option has been deprecated, please use 'perQuestionResponseMessaging' and 'completionResponseMessaging' in it's place.\n\n"),n&&"undefined"!=typeof n.randomSort&&("undefined"==typeof n.randomSortQuestions&&(n.randomSortQuestions=n.randomSort),"undefined"==typeof n.randomSortAnswers&&(n.randomSortAnswers=n.randomSort),Z+="The 'randomSort' option has been deprecated, please use 'randomSortQuestions' and 'randomSortAnswers' in it's place.\n\n"),""!==Z&&("undefined"!=typeof console?console.warn(Z):alert(Z)),t.config=$.extend(s,n);var ee=t.config.json?t.config.json:"undefined"!=typeof quizJSON?quizJSON:null,ne=t.config.randomSortQuestions?ee.questions.sort(function(){return Math.round(Math.random())-.5}):ee.questions,te=ne.length;t.config.numberOfQuestions&&te>=t.config.numberOfQuestions&&(ne=ne.slice(0,t.config.numberOfQuestions),te=ne.length);var ie={method:{getKey:function(e){var n=[];for(i=0;i<e;i++)n[i]=$.Deferred();return n},turnKeyAndGo:function(e,n){$.when.apply(null,e).then(function(){n()})},getKeyNotch:function(e,n){return function(){e[n-1].resolve()}}}};t.method={setupQuiz:function(e){var n,o,s;n=ie.method.getKey(3),o=ie.method.getKeyNotch,s=o,J.hide().html(t.config.nameTemplateText.replace("%name",ee.info.name)).fadeIn(1e3,s(n,1)),V.hide().prepend($('<div class="quizDescription">'+ee.info.main+"</div>")).fadeIn(1e3,s(n,2)),E.append(ee.info.results),t.config.tryAgainText&&""!==t.config.tryAgainText&&E.append('<p><a class="button button-primary button-small allports '+Q+'" href="#">'+t.config.tryAgainText+"</a></p>");var p=$('<ol class="'+r+'"></ol>'),f=1;for(i in ne)if(ne.hasOwnProperty(i)){var h=ne[i],w=$('<li class="'+c+'" id="question'+(f-1)+'"></li>');t.config.displayQuestionCount&&w.append('<div class="'+l+'">'+t.config.questionCountText.replace("%current",'<span class="current">'+f+"</span>").replace("%total",'<span class="total">'+te+"</span>")+"</div>");var z="";z=t.config.displayQuestionNumber?t.config.questionTemplateText.replace("%count",f).replace("%text",h.q):h.q,w.append("<h2>"+z+"</h2>");var x=0;for(i in h.a)h.a.hasOwnProperty(i)&&(answer=h.a[i],answer.correct&&x++);var C=$('<ul class="'+u+'"></ul>'),T=t.config.randomSortAnswers?h.a.sort(function(){return Math.round(Math.random())-.5}):h.a,q=h.select_any?h.select_any:!1,A=h.force_checkbox?h.force_checkbox:!1,R=x>1&&!q||A,S=a.attr("id")+"_question"+(f-1),K=R?"checkbox":"radio";f==ee.questions.length&&(b=b+" "+k);for(i in T)if(T.hasOwnProperty(i)){answer=T[i],optionId=S+"_"+i.toString();var N='<input id="'+optionId+'" name="'+S+'" type="'+K+'" /> ',I='<label for="'+optionId+'">'+answer.option+"</label>",M=$("<li></li>").append(N).append(I);C.append(M)}if(w.append(C),t.config.perQuestionResponseMessaging||t.config.completionResponseMessaging){var O=$('<ul class="'+d+'"></ul>');O.append('<li class="'+m+'">'+h.correct+"</li>"),O.append('<li class="'+g+'">'+h.incorrect+"</li>"),w.append(O)}t.config.backButtonText&&""!==t.config.backButtonText&&w.append('<a href="#" class="button button-primary allports '+y+'">'+t.config.backButtonText+"</a>");var _=t.config.nextQuestionText;t.config.completeQuizText&&f==te&&(_=t.config.completeQuizText),t.config.perQuestionResponseMessaging?(w.append('<div class="u-center quizNav"><a href="#" class="button button-primary allports '+b+'">'+_+"</a></div>"),w.append('<div class="u-center quizNav"><a href="#" class="button button-primary allports '+v+'">'+t.config.checkAnswerText+"</a></div>")):w.append('<div class="u-center quizNav"><a href="#" class="button button-primary allports '+b+" "+v+'">'+_+"</a></div>"),p.append(w),f++}H.append(p),t.config.skipStartButton||0==F.length?(F.hide(),t.method.startQuiz.apply(this,[{callback:t.config.animationCallbacks.startQuiz}]),s(n,3).apply(null,[])):F.fadeIn(500,s(n,3)),ie.method.turnKeyAndGo(n,e&&e.callback?e.callback:function(){})},startQuiz:function(e){function n(e){var n=$(o+" "+z+" li").first();n.length&&n.fadeIn(500,function(){e&&e.callback&&e.callback()})}var i,a,s;i=ie.method.getKey(1),a=ie.method.getKeyNotch,s=a,t.config.skipStartButton||0==F.length?n({callback:s(i,1)}):F.fadeOut(300,function(){n({callback:s(i,1)})}),ie.method.turnKeyAndGo(i,e&&e.callback?e.callback:function(){}),t.config.events&&t.config.events.onStartQuiz&&t.config.events.onStartQuiz.apply(null,[])},resetQuiz:function(e,n){var i,a,s;i=ie.method.getKey(1),a=ie.method.getKeyNotch,s=a,Y.fadeOut(300,function(){$(o+" input").prop("checked",!1).prop("disabled",!1),X.attr("class","quizLevel"),$(o+" "+x).removeClass(f).removeClass(h).remove(p),$(o+" "+T).removeClass(m).removeClass(g),$(o+" "+x+","+o+" "+q+","+o+" "+A+","+o+" "+I+","+o+" "+M).hide(),$(o+" "+w+","+o+" "+C+","+o+" "+N).show(),H.append($(o+" "+z)).show(),s(i,1).apply(null,[]),t.method.startQuiz({callback:t.config.animationCallbacks.startQuiz},Y)}),ie.method.turnKeyAndGo(i,n&&n.callback?n.callback:function(){})},checkAnswer:function(e,n){var a,o,s;a=ie.method.getKey(2),o=ie.method.getKeyNotch,s=o;var l=$($(e).parents(x)[0]),r=l.find(C+" li"),c=r.find("input:checked"),u=parseInt(l.attr("id").replace(/(question)/,""),10),d=ne[u].a,v=ne[u].select_any?ne[u].select_any:!1;r.addClass(g);var b=[];for(i in d)if(d.hasOwnProperty(i)){var k=d[i],y=parseInt(i,10);k.correct&&(b.push(y),r.eq(y).removeClass(g).addClass(m))}var Q=[];if(c.each(function(){var e=$(this).attr("id");Q.push(parseInt(e.replace(/(.*\_question\d{1,}_)/,""),10))}),t.config.preventUnanswered&&0===Q.length)return alert(t.config.preventUnansweredText),!1;var w=t.method.compareAnswers(b,Q,v);w?l.addClass(f):l.addClass(h),l.find(w?S:K).show(),t.config.perQuestionResponseMessaging?($(e).hide(),t.config.perQuestionResponseAnswers?l.addClass(p):l.find(C).hide({duration:0,complete:function(){l.addClass(p)}}),l.find("input").prop("disabled",!0),l.find(q).show(),l.find(I).fadeIn(300,s(a,1)),l.find(M).fadeIn(300,s(a,2)),l.find(M).length||s(a,2).apply(null,[])):(s(a,1).apply(null,[]),s(a,2).apply(null,[])),ie.method.turnKeyAndGo(a,n&&n.callback?n.callback:function(){})},nextQuestion:function(e,n){var i,a,o;i=ie.method.getKey(1),a=ie.method.getKeyNotch,o=a;var s=$($(e).parents(x)[0]),l=s.next(x),r=s.find("input:checked");return t.config.preventUnanswered&&0===r.length?!1:(l.length?s.fadeOut(300,function(){l.find(M).show().end().fadeIn(500,o(i,1)),l.find(M).show().end().length||o(i,1).apply(null,[])}):(o(i,1).apply(null,[]),t.method.completeQuiz({callback:t.config.animationCallbacks.completeQuiz})),void ie.method.turnKeyAndGo(i,n&&n.callback?n.callback:function(){}))},backToQuestion:function(e,n){var t,i,a;t=ie.method.getKey(2),i=ie.method.getKeyNotch,a=i;var o=$($(e).parents(x)[0]),s=o.find(q);if("block"===s.css("display"))o.find(q).fadeOut(300,function(){o.removeClass(f).removeClass(h).removeClass(p),o.find(q+", "+A).hide(),o.find(C).show(),o.find(T).removeClass(m).removeClass(g),o.find("input").prop("disabled",!1),o.find(C).fadeIn(500,a(t,1)),o.find(N).fadeIn(500,a(t,2)),o.find(I).hide(),"question0"!=o.attr("id")?o.find(M).show():o.find(M).hide()});else{var l=o.prev(x);o.fadeOut(300,function(){l.removeClass(f).removeClass(h).removeClass(p),l.find(q+", "+A).hide(),l.find(C).show(),l.find(T).removeClass(m).removeClass(g),l.find("input").prop("disabled",!1),l.find(I).hide(),l.find(N).show(),"question0"!=l.attr("id")?l.find(M).show():l.find(M).hide(),l.fadeIn(500,a(t,1)),a(t,2).apply(null,[])})}ie.method.turnKeyAndGo(t,n&&n.callback?n.callback:function(){})},completeQuiz:function(e){var n,i,a;n=ie.method.getKey(1),i=ie.method.getKeyNotch,a=i;var s=$(o+" "+R).length,l=s;if(t.config.scoreAsPercentage&&(l=100*(s/te).toFixed(2)+"%"),t.config.disableScore?$(L).remove():$(L+" span").html(t.config.scoreTemplateText.replace("%score",l).replace("%total",te)),t.config.disableRanking)$(j).remove();else{var r=[ee.info.level1,ee.info.level2,ee.info.level3,ee.info.level4,ee.info.level5],c=t.method.calculateLevel(s),u=$.isNumeric(c)?r[c]:"";$(j+" span").html(u),$(j).addClass("level"+c)}H.fadeOut(300,function(){t.config.completionResponseMessaging?($(o+" .button:not("+O+"), "+o+" "+w).hide(),$(o+" "+x+", "+o+" "+C+", "+o+" "+q).show(),Y.append($(o+" "+z)).fadeIn(500,a(n,1))):Y.fadeIn(500,a(n,1))}),ie.method.turnKeyAndGo(n,e&&e.callback?e.callback:function(){}),t.config.events&&t.config.events.onCompleteQuiz&&t.config.events.onCompleteQuiz.apply(null,[{questionCount:te,score:s}])},compareAnswers:function(e,n,t){return t?$.inArray(n[0],e)>-1:0===$(e).not(n).length&&0===$(n).not(e).length},calculateLevel:function(e){var n=(e/te).toFixed(2),i=null;return t.method.inRange(0,.2,n)?i=4:t.method.inRange(.21,.4,n)?i=3:t.method.inRange(.41,.6,n)?i=2:t.method.inRange(.61,.8,n)?i=1:t.method.inRange(.81,1,n)&&(i=0),i},inRange:function(e,n,t){return t>=e&&n>=t}},t.init=function(){t.method.setupQuiz.apply(null,[{callback:t.config.animationCallbacks.setupQuiz}]),F.on("click",function(e){e.preventDefault(),this.disabled||$(this).hasClass("disabled")||t.method.startQuiz.apply(null,[{callback:t.config.animationCallbacks.startQuiz}])}),$(o+" "+O).on("click",function(e){e.preventDefault(),t.method.resetQuiz(this,{callback:t.config.animationCallbacks.resetQuiz})}),$(o+" "+N).on("click",function(e){e.preventDefault(),t.method.checkAnswer(this,{callback:t.config.animationCallbacks.checkAnswer})}),$(o+" "+M).on("click",function(e){e.preventDefault(),t.method.backToQuestion(this,{callback:t.config.animationCallbacks.backToQuestion})}),$(o+" "+I).on("click",function(e){e.preventDefault(),t.method.nextQuestion(this,{callback:t.config.animationCallbacks.nextQuestion})});var e=a.attr("id")+"-name";J.attr("id",e),a.attr({"aria-labelledby":e,"aria-live":"polite","aria-relevant":"additions",role:"form"}),$(_+', [href = "#"]').attr("role","button")},t.init()},$.fn.slickQuiz=function(e){return this.each(function(){if(void 0===$(this).data("slickQuiz")){var n=new $.slickQuiz(this,e);$(this).data("slickQuiz",n)}})}}(jQuery);